# 黑屏问题修复说明

## 问题
修改完前端脚本后，进游戏出现黑屏。

## 已修复的问题

### 1. BasePeoleModel.showNono 逻辑错误
**问题**：`else if(param2 != 0)` 和 `else` 分支逻辑重复，导致他人飞行时可能创建两次模型。

**修复**：移除了多余的 `else if(param2 != 0)` 分支，他人飞行时统一使用 `NonoFlyModel`。

**修改位置**：`BasePeoleModel.as` 的 `showNono` 方法

### 2. BasePeoleModel.FLY_MODE case 空值检查
**问题**：在 FLY_MODE case 中访问 `param1.data.actionType`、`this.clickMc`、`this.skeleton` 等可能未初始化的对象。

**修复**：添加了空值检查：
- `param1.data != null && param1.data.hasOwnProperty("actionType")`
- `this.clickMc != null`
- `this.skeleton != null`

**修改位置**：`BasePeoleModel.as` 的 `onAction` 方法中 `case PeopleActionEvent.FLY_MODE`

### 3. UserListCmdListener dispatchAction 空值检查
**问题**：在 2003 处理中 dispatch FLY_MODE 时，模型可能为 null。

**修复**：添加了 `_loc3_ != null` 检查。

**修改位置**：`UserListCmdListener.as` 的 `onUserList` 方法

## 验证步骤

1. **重新编译 SWF**
   - 确保所有修改的 .as 文件都已编译进 NieoCore.swf
   - 检查编译是否有错误或警告

2. **清缓存并测试**
   - 清空浏览器缓存或使用无痕模式
   - 重新加载游戏
   - 检查是否能正常进入游戏

3. **如果仍黑屏**
   - 检查浏览器控制台（F12）是否有 JavaScript/Flash 错误
   - 检查 Flash Player 调试日志（如果启用）
   - 确认 SWF 文件是否正确加载（网络面板查看）

## 可能的原因

如果修复后仍黑屏，可能的原因：

1. **编译错误**：ActionScript 代码在编译时出错，SWF 无法正常运行
2. **运行时错误**：代码在运行时抛出异常，导致游戏停止渲染
3. **初始化顺序问题**：某些对象在初始化时访问了未初始化的依赖
4. **SWF 版本不匹配**：编译的 SWF 版本与客户端期望的版本不一致

## 排查建议

1. **检查编译日志**：查看是否有编译错误或警告
2. **启用 Flash 调试**：在 Flash Player 中启用调试模式，查看运行时错误
3. **逐步回退**：如果可能，逐个回退修改，找出导致黑屏的具体修改
4. **检查依赖**：确认所有 import 的类都存在且可访问
